!function($){"use strict";function checkCompareStatement(a,b,c){switch(null!==a&&"undefined"!=typeof a||(a=""),c){case"=":return $.isArray(a)&&$.isArray(b)?0===$(a).not(b).length&&0===$(b).not(a).length:a==b;case">=":return a>=b;case">":return a>b;case"<=":return a<=b;case"<":return a<b;case"contains":if($.isArray(a))return $.inArray(b,a)>-1;if("string"==$.type(a))return a.indexOf(b)>-1;case"in":if($.isArray(a)){var d=!1;return $.each(a,function(a,c){$.isNumeric(c)&&(c=parseInt(c)),b.indexOf(c)>-1&&(d=!0)}),d}return b.indexOf(a)>-1;case"start_with":return 0===a.indexOf(b);case"starts with":return 0===a.indexOf(b);case"end_with":return b=new RegExp(b+"$"),b.test(a);case"ends with":return b=new RegExp(b+"$"),b.test(a);case"match":return b=new RegExp(b),b.test(a);case"between":if($.isArray(b)&&"undefined"!=typeof b[0]&&"undefined"!=typeof b[1])return checkCompareStatement(a,b[0],">=")&&checkCompareStatement(a,b[1],"<=")}}function getFieldValue(fieldName,$scope){if(checkCompareStatement(fieldName,"(","contains"))return eval(fieldName);if($("#"+fieldName).length&&"checkbox"!==$("#"+fieldName).attr("type")&&"undefined"!=typeof $("#"+fieldName).val()&&null!=$("#"+fieldName).val()&&""==$scope&&(fieldName="#"+fieldName),checkCompareStatement(fieldName,"#","start_with")&&"checkbox"!==$(fieldName).attr("type")&&"undefined"!=typeof $(fieldName).val()&&null!=$(fieldName).val()&&""==$scope)return $(fieldName).val();var selector=null;if($('[name="'+fieldName+'"]').length&&(selector='[name="'+fieldName+'"]'),$('[name*="'+fieldName+'"]').length&&(selector='[name*="'+fieldName+'"]'),null!==selector){var selectorType=$(selector).attr("type");if($.inArray(selectorType,["text","file"])>-1)return""==$scope?$(selector).val():$scope.find(selector).val();if($.inArray(selectorType,["checkbox","radio","hidden"])>-1){var arr=[],elements=[];return elements="hidden"!==selectorType||"post_category"===fieldName||checkCompareStatement(selector,"tax_input","contains")?""!=$scope?$scope.find(selector+":checked"):$(selector+":checked"):""!=$scope?$scope.find(selector):$(selector),elements.length>1&&"radio"!=selectorType?elements.each(function(){arr.push($(this).val())}):arr=1===elements.length?elements.val():0,arr}return""==$scope?$(selector).val():$scope.find(selector).val()}return 0}function isLogicCorrect(a,b){var c="undefined"!=typeof a.relation?a.relation:"and",d="and"==c;return $.each(a.when,function(a,e){var f=getFieldScope(b,e[0]),g=guessSelector(e[0]);g=""!=f?f.find(g):$(g);var h=g.closest(".rwmb-field").attr("data-visible");if("hidden"==h)d="hidden";else{var i=getFieldValue(e[0],f),j=e[1],k=e[2],l=!1,m=!1;$.isArray(i)&&1===i.length&&(i=i[0]),(checkCompareStatement(j,"not","contains")||checkCompareStatement(j,"!","contains"))&&(m=!0,j=j.replace("not",""),j=j.replace("!","")),j=j.trim(),$.isNumeric(i)&&(i=parseInt(i)),l=checkCompareStatement(i,k,j),m&&(l=!l),d="and"===c?d&&l:d||l}}),d}function getFieldScope(a,b){b=guessSelector(b);var c="",d=$(b).closest(".rwmb-clone");return d.length&&""!=a?(d.addClass("field-scope"),c=a.closest(".field-scope"),d.removeClass("field-scope"),c):c}function runConditionalLogic(a){window.eventSource=[],$(".rwmb-conditions").each(function(){var a=$(this),b=a.data("conditions"),c="undefined"!=typeof b.hidden?"hidden":"visible",d=b[c],e=isLogicCorrect(d,a),f=a.parent().hasClass("rwmb-field")?a.parent():a.closest(".postbox");e===!0?"visible"==c?applyVisible(f):applyHidden(f):e===!1?"visible"==c?applyHidden(f):applyVisible(f):"hidden"===e&&applyHidden(f),$.each(d.when,function(a,b){if(!checkCompareStatement(b[0],"(","contains")){var c=guessSelector(b[0]);$.inArray(c,window.eventSource)<0&&"undefined"!=typeof c&&window.eventSource.push(c)}})}),$.each(a,function(a,b){$.each(b,function(b,c){if("undefined"!=typeof c.when){var d=guessSelector(a),e=isLogicCorrect(c,"");e===!0?"visible"==b?applyVisible($(d)):applyHidden($(d)):e===!1?"visible"==b?applyHidden($(d)):applyVisible($(d)):"hidden"===e&&applyHidden($(d)),$.each(c.when,function(a,b){if(!checkCompareStatement(b[0],"(","contains")){var c=guessSelector(b[0]);$.inArray(c,window.eventSource)<0&&"undefined"!=typeof c&&window.eventSource.push(c)}})}})}),window.eventSource.push(".add-clone"),window.eventSource=window.eventSource.join()}function guessSelector(a){if(checkCompareStatement(a,"(","contains"))return null;if($(a).length||isUserDefinedSelector(a))return a;try{if($("#"+a).length&&"checkbox"!==$("#"+a).attr("type")&&!$("#"+a).attr("name"))return"#"+a;if($('[name="'+a+'"]').length)return'[name="'+a+'"]';if($('[name^="'+a+'"]').length)return'[name^="'+a+'"]';if($('[name*="'+a+'"]').length)return'[name*="'+a+'"]'}catch(a){console.log(a)}}function isUserDefinedSelector(a){return checkCompareStatement(a,".","starts with")||checkCompareStatement(a,"#","starts with")||checkCompareStatement(a,"[name","contains")||checkCompareStatement(a,">","contains")||checkCompareStatement(a,"*","contains")||checkCompareStatement(a,"~","contains")}function applyVisible(a){a.closest(".rwmb-field").length&&(a=a.closest(".rwmb-field")),a.hasClass("rwmb-column")?a.css("visibility","visible"):a.show(),a.attr("data-visible","visible")}function applyHidden(a){a.closest(".rwmb-field").length&&(a=a.closest(".rwmb-field")),a.hasClass("rwmb-column")?a.css("visibility","hidden"):a.hide(),a.attr("data-visible","hidden")}var conditions=window.conditions;runConditionalLogic(conditions),window.eventSource.length>1&&$(window.eventSource).on("change keyup click",function(a){runConditionalLogic(conditions)})}(jQuery);